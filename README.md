# Zebra Device Usage -  Developer's Guide

## Getting started
This app is used for detecting Throw or Free fall of Android device using accelerometer. The Android services that collects data from 
accelerometer sensor. 
Accelerometer provides 3D-data of X, Y and Z direction. This data saved with corresponding timestamp into database.

Using data analysis/engineering this app detects different events.


## Services
Service is a basic android component that helps to run in long running operation in the background. Service doesn't have any UI. For more
info on Service follow this [link](https://developer.android.com/guide/components/services)
* LifeTimeService

#### LifeTimeService
It is a foreground service. It's runs in background with a foreground notification. In background this service runs 24x7 collects
Accelerometer data and save into database table called accelerometer_log.


## Broadcast Receiver
Broadcast Receiver is a android component that helps to receive broadcast events. For more info on Broadcast Receiver follow this 
[link](https://developer.android.com/guide/components/broadcasts)
* BootReceiver
* PowerConnectionReceiver

#### BootReceiver
It detects System reboot and restarts `LifeTimeService`. 

#### PowerConnectionReceiver
It detects an event while device connects to a power source and disconnect from the power source.
Based on power connect event device starts exporting `accelerometer_log` table data into a CSV file and delete exported records from 
database.



## Database Tables
* accelerometer_log
* csv_file_log

#### accelerometer_log
|id(AutoGenerate PrimaryKey) |ts(Unique)   |X               |Y               |Z               |
|:--------------------------:|-------------|----------------|----------------|----------------|
|1                           |1616070150276|0.0             |9.77630996704101|0.8123490214347 |
|2                           |1616070150298|0.81234902143478|0.0             |9.8163099670410 |
|3                           |1616070150319|9.81630996704101|0.81234902143478|0.0             |

>**id : Long**                                    **Constrain : AutoGenerate PrimaryKey** 
>**ts : Long**   *TimeStamp in millisecond*       **Constrain : Unique**        
>**X  : float**  *x coordinate values*     
>**Y  : float**  *y coordinate values*     
>**Z  : float**  *z coordinate values*          

#### csv_file_log
|file_name(Unique)    |count    |id(AutoGenerate PrimaryKey) |
|---------------------|:-------:|:--------------------------:|
|timestamp.csv        |100      |1                           |
>**file_name : String** Name of the csv file is created based on the initial row timestamp. **Constrain : Unique**          
>**count : Long**       Row count that particular csv file.         
>**id : Long**          Id is a Autogenerated PrimaryKey for this table.                    **Constrain : AutoGenerate PrimaryKey**          
## Utils
* ExportFile
* DateFormatter
* TimeSpan Enum

## Pending plans or TODO
* Implement Event detection using **RandomForest** or **GradientBoosted Tree** algorithm
using **TensorFlow** & **Keras API** and generate `model.tflite` file to use in android.

## Device File Explorer
#### Android 8.0(Oreo) to Android 10(Q), API 26-29
```
parent/root
├── data
|   └── com.alumnus.zebra
|           ├── cache
|           ├── code_cache
|           ├── database
|           |       └── database-name
|           └── shared_prefs
|                   ├── Zebra.xml
|                   └── ZebraSp.xml
├── ...
|
└── sdCard
       ├── Android
       |    ├── data 
       |    ├── media
       |    └── obb
       |
       ├── ...
       |
       └── ZebraApp
               ├── csvData
               └── logs
```
#### Android 11(R), API 30
```
parent/root
├── data
|     ├── ...
|     └── data
|           └── com.alumnus.zebra
|                   ├── cache
|                   ├── code_cache
|                   ├── database
|                   |       └── database-name
|                   └── shared_prefs
|                           ├── Zebra.xml
|                           └── ZebraSp.xml
├── ...
|
└── sdCard
       ├── Alerms
       ├── Android
       |    ├── data 
       |    |     ├── ...
       |    |     └── com.alumnus.Zebra
       |    |               └── files
       |    |                     └── ZebraApp
       |    |                           ├── csvData
       |    |                           └── logs
       |    |
       |    ├── media
       |    └── obb
       |
       ├── DCIM
       ├── Documents
       ├── Download
       ├── Movies
       ├── Music
       ├── Notifications
       ├── Pictures
       └── Ringtones
```

### Target API level
The client requirement for this app is targeting mainly android Oreo(API level 26) devices. 
So this app development is done on focusing both Oreo and higher API level devices. 
Hence it supports in below API level devices 
|Android version name|Version Number|API level|
|--------------|:------------:|:-------:|
| Marshmallow  |      6.0     |    23   |
| Nought       |      7.0     |    24   |
| Oreo         |      7.0     |    26   |
| Pie          |      7.0     |    27   |
| Android 10   |      7.0     |    28   |
